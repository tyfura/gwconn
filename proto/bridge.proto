syntax = "proto3";

option go_package = "github.com/tyfura/gwconn";
option java_multiple_files = true;
option java_package = "io.tyft.gwconn";
option java_outer_classname = "";

import "common.proto";
package gwconn;

// Interface exported by the server.
service Bridge {
  rpc LoginBridge(LoginReq) returns (LoginResp) {}
  rpc RegisterBridge(BridgeInfo) returns (RegisterResp) {} 
  rpc GetTargetStream(JoinStreamReq) returns (stream BridgeTarget) {}
  rpc DnsAcmeChanger(DnsChangerReq) returns (GeneralResp) {}
  rpc SendSystemStat(SystemStat) returns (GeneralResp) {}
  rpc SendRouteInfo(RouteStat) returns (GeneralResp) {}
  rpc SendLog(LogLineMsg) returns (GeneralResp) {}
//  rpc GetVpnCfg() returns (GeneralResp) {}
}

message RegisterResp {
  string key = 2;
}

message BridgeTarget {
  uint32 act = 1;
  string targeId = 2;
  string fqdn = 3;
  string addr = 4;
  uint32 typ = 5;
}


message DnsChangerReq {
  bool isSet = 1;
  string fqdn = 2;
  string val = 3;
}

